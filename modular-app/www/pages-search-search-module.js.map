{"version":3,"sources":["webpack:///./src/app/module-pulstrade/pages/search/search.module.ts","webpack:///./src/app/module-pulstrade/pages/search/search.page.html","webpack:///./src/app/module-pulstrade/pages/search/search.page.scss","webpack:///./src/app/module-pulstrade/pages/search/search.page.ts"],"names":[],"mappings":"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","file":"pages-search-search-module.js","sourcesContent":["import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { SearchPage } from './search.page';\nimport { TranslateHttpLoader } from '@ngx-translate/http-loader';\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\nimport { HttpClient } from '@angular/common/http';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SearchPage\n  }\n];\nexport function HttpLoaderFactory(http: HttpClient) {\n  return new TranslateHttpLoader(http, './assets/strade/i18n/', '.json');\n}\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes),\n    TranslateModule.forRoot({ loader: {\n      provide: TranslateLoader,\n      useFactory: HttpLoaderFactory,\n      deps: [HttpClient]\n    }}),\n  ],\n  schemas: [ CUSTOM_ELEMENTS_SCHEMA ],\n  declarations: [SearchPage]\n})\nexport class SearchPageModule {}\n","module.exports = \"<ion-header no-border>\\n  <ion-toolbar color=\\\"secondary\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>\\n      {{'SEARCH' | translate}}\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-searchbar showCancelButton animated (ionInput)=\\\"search($event)\\\" placeholder=\\\"{{'SEARCH' | translate}}\\\"></ion-searchbar>\\n\\n<ion-content padding>\\n  <ion-list no-lines *ngIf=\\\"showStreets\\\">\\n    <div *ngFor=\\\"let s of showStreets\\\">\\n      <ion-card [id]=\\\"s.id\\\">\\n        <ion-card-content>\\n          <div class=\\\"left\\\" [routerLink]=\\\"['/ps']\\\" [queryParams]=\\\"{coord: s.centralCoordStr}\\\" routerDirection=\\\"forward\\\">\\n            <b>{{s.cleaningDayStr}}</b>\\n            <h1>{{s.streetName}}</h1>\\n            <p>{{'CLOSED' | translate}} <b>{{s.stopStartingTimeStr}}</b> - <b>{{s.stopEndingTimeStr}}</b></p>\\n          </div>\\n          <div class=\\\"right\\\">\\n            <ion-toggle [id]=\\\"'tog-' + s.idNumber\\\" (ionChange)=\\\"toggle($event)\\\" [value]=\\\"s.streetName\\\"></ion-toggle>\\n          </div>\\n          <p [id]=\\\"'not-' + s.idNumber\\\" class=\\\"notification\\\">{{'NOTIFY-DIS' | translate}}</p>\\n        </ion-card-content>\\n      </ion-card>\\n    </div>\\n  </ion-list>\\n</ion-content>\"","module.exports = \"ion-card {\\n  background: white !important; }\\n\\n.left {\\n  float: left;\\n  width: 75%;\\n  padding-bottom: 5%; }\\n\\n.right {\\n  float: right;\\n  vertical-align: middle; }\\n\\n.notification {\\n  text-align: center; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2NoaW44L0RvY3VtZW50cy93b3JrL21vZHVsYXJBcHAvbW9kdWxhci1hcHAvc3JjL2FwcC9tb2R1bGUtcHVsc3RyYWRlL3BhZ2VzL3NlYXJjaC9zZWFyY2gucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksNkJBQTRCLEVBQy9COztBQUNEO0VBQ0ksWUFBVztFQUNYLFdBQVU7RUFDVixtQkFBa0IsRUFDckI7O0FBQ0Q7RUFDSSxhQUFZO0VBQ1osdUJBQXNCLEVBQ3pCOztBQUNEO0VBQ0ksbUJBQWtCLEVBQ3JCIiwiZmlsZSI6InNyYy9hcHAvbW9kdWxlLXB1bHN0cmFkZS9wYWdlcy9zZWFyY2gvc2VhcmNoLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImlvbi1jYXJkIHtcbiAgICBiYWNrZ3JvdW5kOiB3aGl0ZSAhaW1wb3J0YW50O1xufVxuLmxlZnQge1xuICAgIGZsb2F0OiBsZWZ0O1xuICAgIHdpZHRoOiA3NSU7XG4gICAgcGFkZGluZy1ib3R0b206IDUlO1xufVxuLnJpZ2h0IHtcbiAgICBmbG9hdDogcmlnaHQ7XG4gICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbn1cbi5ub3RpZmljYXRpb24ge1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbn0iXX0= */\"","import { Component, OnInit } from '@angular/core';\nimport { TranslateService } from '@ngx-translate/core';\nimport { ConfigService } from 'src/app/services/config.service';\nimport { Router, ActivatedRoute } from '@angular/router';\nimport { MapService } from '../../services/map.service';\nimport { DatePipe } from '@angular/common';\nimport { NotificationService } from '../../services/notification.service';\nimport { Platform } from '@ionic/angular';\n\n@Component({\n  selector: 'app-search',\n  templateUrl: './search.page.html',\n  styleUrls: ['./search.page.scss'],\n  providers: [DatePipe]\n})\nexport class SearchPage implements OnInit {\n\n  language: string;\n  myPos: any;\n  streets: any;\n  showStreets: any = [];\n  constructor(private translate: TranslateService,\n    private config: ConfigService,\n    private router: Router,\n    private mapSrv: MapService,\n    private datePipe: DatePipe,\n    private notificationSrv: NotificationService,\n    private route: ActivatedRoute,\n    private platform: Platform\n  ) {\n    this.language = window[this.config.getAppModuleName()]['language'];\n    this.translate.use(this.language);\n    this.myPos = window[this.config.getAppModuleName()]['geolocation'];\n  }\n\n  ngOnInit() {\n    this.streets = this.mapSrv.getData();\n    /** Add DateTimes in string format */\n    this.streets.forEach(s => {\n      s.cleaningDayStr = this.datePipe.transform(s.cleaningDay, 'dd/MM/yyyy');\n      let tmp = new Date(s.stopStartingTime).toLocaleTimeString().split(':');\n      s.stopStartingTimeStr = `${tmp[0]}:${tmp[1]}`;\n      tmp = new Date(s.stopEndingTime).toLocaleTimeString().split(':');\n      s.stopEndingTimeStr = `${tmp[0]}:${tmp[1]}`;\n      s.centralCoordStr = JSON.stringify(s.centralCoords);\n      s.idNumber = parseInt(s.streetCode.replace(/\\_/g, ''), 10);\n    });\n\n    /** Parse URL params */\n    try {\n      this.route.queryParams\n        .subscribe(params => {\n          this.search(params.street);\n        });\n    } catch { }\n  }\n\n  /**\n   * Set searchbar focus\n   */\n  ionViewDidEnter() {\n    const el = document.querySelector('ion-searchbar');\n    if (el) {\n      el.setFocus();\n    }\n  }\n\n  /**\n   * Search streets and put them in `showStreets` object\n   * @param input `(change)` event\n   */\n  search(input: any) {\n    let val;\n    if (input) {\n      if (input.detail) {\n        val = input.detail.target.value;\n      } else {\n        val = input;\n      }\n      if (val === '') {\n        this.showStreets = [];\n      } else {\n        this.showStreets = this.streets.filter(function (el) {\n          return (el.streetName.toLowerCase().indexOf(val.toLowerCase()) > -1);\n        });\n      }\n    }\n  }\n\n  /**\n   * Go to map page with specified coordinates\n   * @param coord Street coordinates\n   */\n  showInMap(coord) {\n    this.router.navigate(['/ps'], { queryParams: { coord: JSON.stringify(coord) } });\n  }\n\n  /**\n   * Enable or disable notifications\n   * @param event `click` event\n   */\n  toggle(event) {\n    this.platform.ready().then(() => {\n      let element, toggle: any;\n      const street = this.streets.filter(function (val) {\n        return val.streetName === event.detail.value;\n      });\n      if (event.detail.checked) {\n        street.forEach(s => {\n          element = document.getElementById('not-' + s.idNumber);\n          toggle = document.getElementById('tog-' + s.idNumber);\n          this.notificationSrv.setNotification(street);\n          element.style.color = 'green';\n          this.translate.get('NOTIFY-ENA').subscribe(x => {\n            element.innerHTML = x;\n          });\n          toggle.checked = true;\n        });\n      } else {\n        street.forEach(s => {\n          element = document.getElementById('not-' + s.idNumber);\n          toggle = document.getElementById('tog-' + s.idNumber);\n          this.notificationSrv.disableNotification(street);\n          element.style.color = '#737373';\n          this.translate.get('NOTIFY-DIS').subscribe(x => {\n            element.innerHTML = x;\n          });\n          toggle.checked = false;\n        });\n      }\n    });\n  }\n}\n"],"sourceRoot":""}