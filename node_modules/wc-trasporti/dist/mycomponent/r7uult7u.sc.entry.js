const t=window.mycomponent.h;import{a as e}from"./chunk-43a1777c.js";class i{constructor(){this.rowHeight=20,this.headerRowHeight=25,this.stopsColWidth=100,this.tableStyle="ic_text_size",this.headervariable=90,this.stopsColLineHeight=20,this.headerHeight=44+this.headervariable+1,this.cellWidthBase=50,this.cellHeightBase=28,this.firstRowHeight=28,this.scrollLeftPosition=0,this.tt=null,this.runningDate=new Date,this.expandStr=function(t){if(t.length<9){for(var e=9-t.length,i=Math.round(e/2),s=0;s<i;s++)t="&nbsp;"+t;for(s=0;s<e-i;s++)t+="&nbsp"}return t}}changeStyle(){this.changeStyleTable()}handleScroll(t){console.log("the body was scrolled",t)}setBiggerStyle(){this.littletable=!0,this.rowHeight=30,this.headerRowHeight=30,this.stopsColWidth=150,this.stopsColLineHeight=30;var t=this.element.shadowRoot.querySelector("#header-table"),e=90;t&&(e=t.clientHeight),this.headervariable=e+5*this.header_row_number;var i=44+this.headervariable+1;this.fontsize=16,this.scrollHeight=window.innerHeight-i}setSmallerStyle(){this.littletable=!1,this.rowHeight=20,this.stopsColWidth=100,this.fontsize=12,this.stopsColLineHeight=20;var t=this.element.shadowRoot.querySelector("#header-table"),e=90;t&&(e=t.clientHeight),this.headervariable=e+5*this.header_row_number,this.scrollHeight=window.innerHeight-(44+this.headervariable+1)}changeStyleTable(){setTimeout(()=>{this.littletable?this.setSmallerStyle():this.setBiggerStyle(),this.tableStyle=this.littletable?"ic_text_size":"ic_text_size_outline"},100),setTimeout(function(){},2e3)}initMeasures(t,e){this.stopsColWidth=window.innerHeight<window.innerWidth?170:this.littletable?150:100,this.header=null,this.col=null,t.tripIds&&0!=t.tripIds.length&&(this.tableHeight=t.stops.length*this.rowHeight,this.scrollWidth=window.innerWidth+(this.accessibility?0:25),this.scrollHeight=window.innerHeight-this.headerHeight,this.tableHeaderHeight=this.header_row_number*this.headerRowHeight,e||setTimeout(function(){},300))}componentWillLoad(){this.changeStyle(),this.buildData()}buildData(){this.dataTT=JSON.parse(this.data),this.rootstyle(),this.Fetch(),this.initMeasures(this.dataTT,!0)}rootstyle(){let t=document.documentElement;t.style.setProperty("--dim-orari-wid",(screen.width-screen.width/100*85).toString()+"px"),t.style.setProperty("--top-table","70px"),t.style.setProperty("--dim-orari-hei",(screen.height-70).toString()+"px"),t.style.setProperty("--dim-fermate-wid",(screen.width-screen.width/100*15.5).toString()+"px"),t.style.setProperty("--dim-fermate-hei",(screen.height-70).toString()+"px")}BiancoNero(t){this.fermate="";for(let e in t)this.fermate+=parseInt(e)%2==0?"<div id='grigioFermate'>":"<div id='biancoFermate'>",this.fermate+=t[e].toString()+"</div>"}componentDidLoad(){const t=this.element.shadowRoot.querySelectorAll("li.my-list");[].forEach.call(t,t=>t.style.color="red"),this.setStyle()}setStyle(){this.titleBar=this.element.shadowRoot.querySelector(".titleBar"),this.titleBar&&(this.titleBar.style.backgroundColor=this.color,this.titleBar.style.color=this.textColor(this.color)),this.directionBar=this.element.shadowRoot.querySelector(".directionBar"),this.directionBar&&(this.directionBar.style.backgroundColor=this.color,this.directionBar.style.color=this.textColor(this.color)),this.subtitleBar=this.element.shadowRoot.querySelector(".day-bar"),this.subtitleBar&&(this.subtitleBar.style.backgroundColor=this.color,this.subtitleBar.style.color=this.textColor(this.color))}getDelayValue(t){var e="";return t&&t.SERVICE&&t.SERVICE>0&&(e+=t.SERVICE+"'"),t&&t.USER&&t.USER>0&&(e.length>0&&(e+=" / "),e+=t.USER+"'"),e}StampaOrari(t){var e,i,s="";if(t)for(var r=0;r<t.length;r++){if(e=new Date(t[r].time),0==r&&(s="<span class='hour'>"+(e.getHours()<10?" ":"")+e.getHours()+"</span>|"),r>0&&i&&e.getHours()!=i.getHours()){if(e.getDay()!=i.getDay())break;s+="<br/><span class='hour'>"+e.getHours()+"</span>|"}s+="&nbsp;&nbsp;"+(e.getHours()<10?"0":"")+e.getHours()+":"+(e.getMinutes()<10?"0":"")+e.getMinutes()+"&nbsp;&nbsp;",i=e}this.orari=s}getTripText(t){return t}Fetch(){this.dataTT&&(console.log(this.dataTT),this.StampaOrari(this.dataTT)),this.citta&&this.numero&&this.remoteFetch()}remoteFetch(){fetch("https://os.smartcommunitylab.it/core.mobility/timetable/"+this.citta+"/"+this.numero).then(t=>{t.json()}).then(t=>{this.dataTT=t.stopNames,this.BiancoNero(this.dataTT),this.dataTT=t.trips,this.StampaOrari(this.dataTT.times)})}scrollOrari(t){t=t,null==this.header&&(this.header=this.element.shadowRoot.querySelector("#table-header")),null==this.col&&(this.col=this.element.shadowRoot.querySelector("#table-col"));var e=t.detail.currentX;null!=this.header&&(this.header.style.top=t.detail.currentY+"px"),null!=this.col&&(this.col.style.left=e+"px")}visualizza(t){return t}prevDate(){this.changeDateEvent.emit("prevDate")}nextDate(){this.changeDateEvent.emit("nextDate")}textColor(t){return this.isDarkColor(t)?"#fff":"#000"}isDarkColor(t){if(!t)return!0;var e=t.substring(1),i=parseInt(e,16);return((i>>16&255)+(i>>8&255)+(i>>0&255))/3<128}render(){var e={left:"50%",top:`${this.tableHeaderHeight}px`,lineHeight:`${this.stopsColLineHeight}px`,backgroundSize:`100% ${2*this.rowHeight}px`,fontSize:`${this.fontsize}px`,backgroundImage:`linear-gradient(180deg,transparent, transparent ${this.rowHeight}px, #eee ${this.rowHeight}px, #eee ${2*this.rowHeight}px)`};return[t("div",null,t("div",{id:"header-table"},t("div",{class:"row titleBar"},t("div",{class:"col tt-subtitle"},this.route)),t("div",{class:"row directionBar"},t("div",{class:"col tt-subtitle"},this.name)),t("ion-row",{class:"day-bar"},t("ion-col",{size:"1",class:"col col-25 tt-day btn",onClick:()=>this.prevDate()},t("ion-icon",{name:"arrow-dropleft"})),t("ion-col",{size:"10",class:"col col-50 tt-day"},this.formatDate(this.day,"ddd")," ",this.formatDate(this.day,"D/M/YYYY")),t("ion-col",{size:"1",class:"col col-25 tt-day btn",onClick:()=>this.nextDate()},t("ion-icon",{name:"arrow-dropright"})))),t("div",{id:"table-table",innerHTML:this.visualizza(this.orari),style:e}))]}formatDate(t,i){return e(Number(t)).format(i)}static get is(){return"wc-trasporti-stop"}static get encapsulation(){return"shadow"}static get properties(){return{accessibility:{type:Boolean,attr:"accessibility"},arrows:{type:Boolean,attr:"arrows"},citta:{type:String,attr:"citta"},color:{type:String,attr:"color"},data:{type:String,attr:"data"},dataTT:{state:!0},day:{type:String,attr:"day"},element:{elementRef:!0},fermate:{state:!0},font:{type:String,attr:"font"},fontsize:{state:!0},labeldelay:{type:String,attr:"labeldelay"},labeltrips:{type:String,attr:"labeltrips"},littletable:{type:Boolean,attr:"littletable",watchCallbacks:["changeStyle"]},name:{type:String,attr:"name"},numero:{type:String,attr:"numero"},orari:{state:!0},route:{type:String,attr:"route"},showtrips:{type:Boolean,attr:"showtrips"},tripsvalue:{type:String,attr:"tripsvalue"}}}static get events(){return[{name:"changeDateEvent",method:"changeDateEvent",bubbles:!0,cancelable:!0,composed:!0},{name:"showStopEvent",method:"showStopEvent",bubbles:!0,cancelable:!0,composed:!0}]}static get listeners(){return[{name:"scroll",method:"handleScroll",passive:!0}]}static get style(){return"#colonna1.sc-wc-trasporti-stop{width:20%}#colonna1.sc-wc-trasporti-stop, #riga1.sc-wc-trasporti-stop{position:relative}#riga1.sc-wc-trasporti-stop{height:6%}*.sc-wc-trasporti-stop{font-family:monospace}#listaFermate.sc-wc-trasporti-stop{position:absolute;top:var(--top-table);height:var(--dim-orari-hei);overflow:auto;overflow-y:hidden}#fermate.sc-wc-trasporti-stop{position:absolute;top:0;min-width:100px;max-width:300px;width:10%}#contentFermate.sc-wc-trasporti-stop{height:800px;width:300px}#myDIV.sc-wc-trasporti-stop{position:absolute;top:var(--top-table);height:var(--dim-fermate-hei);width:var(--dim-fermate-wid);overflow:auto;overflow-x:var(--blocca-barra)}#content.sc-wc-trasporti-stop{height:800px;width:2000px}#orari.sc-wc-trasporti-stop{position:absolute;top:0;width:10%;left:15%}#biancoOrari.sc-wc-trasporti-stop{background-color:#fff}#biancoOrari.sc-wc-trasporti-stop, #grigioOrari.sc-wc-trasporti-stop{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;position:relative}#grigioOrari.sc-wc-trasporti-stop{background-color:#eee}#biancoFermate.sc-wc-trasporti-stop{background-color:#fff;position:relative}#grigioFermate.sc-wc-trasporti-stop{background-color:#eee;position:relative}.sc-wc-trasporti-stop::-webkit-scrollbar{width:10px}.sc-wc-trasporti-stop::-webkit-scrollbar-thumb, .sc-wc-trasporti-stop::-webkit-scrollbar-track{background:hsla(0,0%,100%,0)}.sc-wc-trasporti-stop::-webkit-scrollbar-thumb:hover{background:hsla(0,0%,100%,0)}.tt-day.sc-wc-trasporti-stop{font-size:20px;line-height:40px;text-align:center;padding:0;text-transform:uppercase;white-space:nowrap}.tt-day.btn.sc-wc-trasporti-stop{font-size:30px}.tt-day.btn.sc-wc-trasporti-stop   a.activated.sc-wc-trasporti-stop, .tt-day.btn.sc-wc-trasporti-stop   a.sc-wc-trasporti-stop:active, .tt-day.btn.sc-wc-trasporti-stop   a.sc-wc-trasporti-stop:focus, .tt-day.btn.sc-wc-trasporti-stop   a.sc-wc-trasporti-stop:hover{opacity:.5}#table-header.sc-wc-trasporti-stop{white-space:nowrap;font-family:RobotoMono;position:absolute;background-color:#fff;font-size:12px;z-index:10}#table-header.sc-wc-trasporti-stop   div.sc-wc-trasporti-stop{border-bottom:1px solid #bbb;height:25px}#table-header.sc-wc-trasporti-stop   div.sc-wc-trasporti-stop:first-child{color:#cd251c}.header-row-types.sc-wc-trasporti-stop{height:20px}#table-table.sc-wc-trasporti-stop{white-space:nowrap;font-size:12px;position:absolute;-webkit-transform:translate(-50%);transform:translate(-50%);-webkit-transition-duration:.3s;-moz-transition-duration:.3s;-o-transition-duration:.3s;transition-duration:.3s}#table-table.sc-wc-trasporti-stop   br.sc-wc-trasporti-stop{font-family:RobotoMono}#table-col.sc-wc-trasporti-stop{line-height:20px;white-space:nowrap;border-right:1px solid #bbb;z-index:10;overflow:hidden;text-overflow:ellipsis}#table-col.sc-wc-trasporti-stop, #table-corner.sc-wc-trasporti-stop{font-size:12px;position:absolute;background-color:#fff;padding-left:3px}#table-corner.sc-wc-trasporti-stop{height:25px;z-index:100;text-align:left}#table-corner.sc-wc-trasporti-stop   div.sc-wc-trasporti-stop{height:25px;border-bottom:1px solid #bbb;border-right:1px solid #bbb;background-color:#fff}#table-corner.sc-wc-trasporti-stop > div.sc-wc-trasporti-stop   .corner-delay.sc-wc-trasporti-stop{margin-left:10px;vertical-align:top}.accessibilityBullet.sc-wc-trasporti-stop{width:20px}.delay.sc-wc-trasporti-stop{padding-left:40px}.table-container.sc-wc-trasporti-stop{padding:0}.table-container.sc-wc-trasporti-stop   ion-scroll.sc-wc-trasporti-stop{margin-top:0}.tt-table.sc-wc-trasporti-stop{position:absolute;left:-25px;-webkit-transition-duration:.3s;-moz-transition-duration:.3s;-o-transition-duration:.3s;transition-duration:.3s}.tt-table-acc.sc-wc-trasporti-stop{left:0!important}.tt-table.sc-wc-trasporti-stop   #table-col.sc-wc-trasporti-stop   div.sc-wc-trasporti-stop{width:20px;display:inline-block;margin-right:5px;text-align:center}.tt-subtitle.sc-wc-trasporti-stop{text-align:center}.table-accessibility.sc-wc-trasporti-stop{color:#2975a7;margin-right:4px;font-size:25px}.hour.sc-wc-trasporti-stop{font-weight:700}.separator.sc-wc-trasporti-stop{height:100%;width:1px;background-color:#000}"}}export{i as WcTrasportiStop};